<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Questões de Múltipla Escolha</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <button id="switch-button" onclick="switchSource()">Mudar Fonte</button>
        <div id="correct-counter">Acertos: 0</div>
        <div id="incorrect-counter">Erros: 0</div>
        <div id="question-container"></div>
        <button id="next-button" onclick="nextQuestion()">Próxima</button>
    </div>
    <script>
        let questions = [];
        let correctCount = 0;
        let incorrectCount = 0;
        let currentQuestion = null;
        let currentSource = 0;
        const sources = [
            'https://luparelli.s3.sa-east-1.amazonaws.com/simulado/climaustentabilidade.json',
            'https://luparelli.s3.sa-east-1.amazonaws.com/simulado/diversidadeinclusao.json',
            'https://luparelli.s3.sa-east-1.amazonaws.com/simulado/papeldobnds.json',
            'https://luparelli.s3.sa-east-1.amazonaws.com/simulado/politicaspublicas.json',
            'https://luparelli.s3.sa-east-1.amazonaws.com/simulado/principioanalisedados.json'
        ];

        // Função para buscar as perguntas do servidor
        async function fetchQuestions() {
            try {
                const response = await fetch(sources[currentSource]);
                if (!response.ok) throw new Error('Failed to fetch questions');
                questions = await response.json();
                nextQuestion();
            } catch (error) {
                console.error('Erro ao buscar perguntas:', error);
                alert('Não foi possível carregar as perguntas.');
            }
        }

        // Função para exibir uma pergunta
        function showQuestion(question) {
            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = '';

            const formattedQuestion = question.pergunta.replace(/:/g, ':<br>').replace(/;/g, ';<br>');
            const questionHtml = `
                <div class="question">
                    <p>${formattedQuestion}</p>
                    <ol>
                        ${question.alternativas.map((alternativa, index) => {
                            const formattedAlternativa = alternativa.replace(/:/g, ':<br>').replace(/;/g, ';<br>');
                            return `<li><label><input type="radio" name="question" value="${String.fromCharCode(65 + index)}"> ${formattedAlternativa}</label></li>`;
                        }).join('')}
                    </ol>
                    <button onclick="checkAnswer('${question.correta}', '${question.explicacao.replace(/'/g, "\\'")}')">Verificar Resposta</button>
                    <div class="explanation" id="explanation"></div>
                </div>
            `;
            questionContainer.innerHTML = questionHtml;
        }

        // Função para verificar a resposta
        function checkAnswer(correctAnswer, explanation) {
            const options = document.getElementsByName('question');
            let selectedAnswer = null;
            let isCorrect = false;

            options.forEach(option => {
                if (option.checked) {
                    selectedAnswer = option.value;
                    if (selectedAnswer === correctAnswer) {
                        option.parentElement.classList.add('correct');
                        option.parentElement.classList.remove('incorrect');
                        isCorrect = true;
                    } else {
                        option.parentElement.classList.add('incorrect');
                        option.parentElement.classList.remove('correct');
                    }
                } else {
                    option.parentElement.classList.remove('correct');
                    option.parentElement.classList.remove('incorrect');
                }
            });

            const explanationDiv = document.getElementById('explanation');
            if (isCorrect) {
                explanationDiv.innerHTML = explanation;
                explanationDiv.style.display = 'block';
                correctCount++;
                document.getElementById('correct-counter').textContent = 'Acertos: ' + correctCount;
            } else if (selectedAnswer !== null) {
                incorrectCount++;
                document.getElementById('incorrect-counter').textContent = 'Erros: ' + incorrectCount;
                explanationDiv.innerHTML = explanation;
                explanationDiv.style.display = 'block';
            }
        }

        // Função para obter uma nova pergunta aleatória
        function nextQuestion() {
            currentQuestion = getRandomQuestion();
            showQuestion(currentQuestion);
        }

        // Função para selecionar uma pergunta aleatória
        function getRandomQuestion() {
            const randomIndex = Math.floor(Math.random() * questions.length);
            return questions[randomIndex];
        }

        // Função para alternar a fonte de perguntas
        function switchSource() {
            currentSource = (currentSource + 1) % sources.length;
            fetchQuestions();
        }

        // Carregar as perguntas ao iniciar a página
        fetchQuestions();
    </script>
</body>
</html>
